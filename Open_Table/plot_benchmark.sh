#!/bin/bash

# CSV file you already generated by running your benchmark
OUT="results.csv"

# Check if file exists
if [ ! -f "$OUT" ]; then
  echo "Error: '$OUT' does not exist. Please run your benchmark first to generate $OUT."
  exit 1
fi

# Use gnuplot to plot the results in a more readable format
gnuplot -persist <<-EOF
    # 1) Terminal settings: bigger window, specify font
    set terminal wxt size 1200,600 enhanced font 'Verdana,8'

    # 2) CSV separator
    set datafile separator ','

    # 3) Title, axis labels, grid
    set title 'Open Table Benchmark'
    set xlabel 'Benchmark'
    set ylabel 'Time per iteration (ns)'
    set grid

    # 4) Rotate x-axis labels vertically for clarity
    set xtics rotate by -90

    # 5) Use a smaller font for x-axis labels to avoid overlap
    set xtics font ',7'

    # 6) Place legend (key) outside the plot
    set key outside

    # 7) (Optional) Log scale if your data spans large ranges
    # set logscale y

    # 8) Use lines+points style instead of a histogram
    set style data linespoints

    # 9) Plot the 3rd column (real_time) vs. the 1st column (benchmark name)
    plot '$OUT' using 3:xtic(1) title 'real_time (ns)'
EOF
